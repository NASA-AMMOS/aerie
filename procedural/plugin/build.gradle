plugins {
  id 'groovy-gradle-plugin'
  id "maven-publish"
}

// adding this as an implementation dependency here allows usage in our convention plugin
dependencies {
  implementation("com.gradleup.shadow:shadow-gradle-plugin:8.3.3")
}

tasks.publish {
  dependsOn("check")
}

publishing {
  publications {
    pluginMaven(MavenPublication)
  }
  repositories {
    maven {
      name="GitHubCopiePackages"
      url="https://maven.pkg.github.com/skovati/copie"
      version=findProperty("publishing.version")
      credentials {
        username = System.getenv("GITHUB_ACTOR")
        password = System.getenv("GITHUB_TOKEN")
      }
    }
  }
}
